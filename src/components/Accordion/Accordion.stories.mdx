import {
  ArgsTable,
  Canvas,
  Description,
  Meta,
  Story,
} from "@storybook/addon-docs";
import ReactDOMServer from "react-dom/server";
import { withDesign } from "storybook-addon-designs";

import Accordion from "./Accordion";
import Card, { CardHeading, CardContent } from "../Card/Card";
import { CardLayouts } from "../Card/CardTypes";
import { HeadingLevels } from "../Heading/HeadingTypes";
import { ImageRatios } from "../Image/ImageTypes";
import { getCategory } from "../../utils/componentCategories";

<Meta
  title={getCategory("Accordion")}
  component={Accordion}
  decorators={[withDesign]}
  parameters={{
    design: {
      type: "figma",
      url: "https://www.figma.com/file/qShodlfNCJHb8n03IFyApM/Master?node-id=10734%3A2520",
    },
    jest: ["Accordion.test.tsx"],
  }}
  argTypes={{
    contentData: { control: false },
    id: { control: false },
    isDefaultOpen: { table: { defaultValue: { summary: false } } },
  }}
/>

# Accordion

| Component Version | DS Version |
| ----------------- | ---------- |
| Added             | `0.1.0`    |
| Latest            | `0.25.10`  |

## Table of Contents

- [Overview](#overview)
- [Component Props](#component-props)
- [Accessibility](#accessibility)
- [FAQ Example](#faq-example)

## Overview

<Description of={Accordion} />

The `Accordion` component displays a list of high-level options that can
expand/collapse to reveal associated sections of content. This component pushes
existing content on the page down. Each accordion item is self contained but
when multiple are rendered together, they render in a "FAQ" style. When multiple
accordions are rendered together, they can each open and close independent of
each other.

The only way to render an `Accordion` component is to pass in an array of objects
with `label` and `panel` properties for each accordion item. Note that you can
pass in a string or DOM elements into the `panel` property in each object. This
approach is needed because, internally, we deal with the logic to render the
necessary icon, Chakra components, and styles.

```jsx
const contentData = [
  {
    label: "Tom Nook",
    panel: (
      <Card
        layout={CardLayouts.Row}
        center
        imageSrc="https://play.nintendo.com/images/AC_Tom_FRYtwIN.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
        imageAlt="Alt text"
        imageAspectRatio={ImageRatios.TwoByOne}
      >
        <CardHeading level={HeadingLevels.Four} id="heading1">
          Tom Nook
        </CardHeading>
        <CardContent>
          Tom Nook, <b>known in Japan as Tanukichi</b>, is a fictional
          character in the Animal Crossing series who operates the
          village store.
        </CardContent>
      </Card>
    ),
  },
];

...

<Accordion contentData={contentData} />
```

## Component Props

<Canvas withToolbar>
  <Story
    name="Accordion with Controls"
    args={{
      contentData: [
        {
          label: "Tom Nook",
          panel: (
            <Card
              layout={CardLayouts.Row}
              center
              imageSrc="https://play.nintendo.com/images/AC_Tom_FRYtwIN.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
              imageAlt="Alt text"
              imageAspectRatio={ImageRatios.TwoByOne}
            >
              <CardHeading level={HeadingLevels.Four} id="heading1">
                Tom Nook
              </CardHeading>
              <CardContent>
                Tom Nook, <b>known in Japan as Tanukichi</b>, is a fictional
                character in the Animal Crossing series who operates the village
                store.
              </CardContent>
            </Card>
          ),
        },
      ],
      id: "accordion-id",
      isDefaultOpen: false,
    }}
  >
    {(args) => <Accordion {...args} />}
  </Story>
</Canvas>

<ArgsTable story="Accordion with Controls" />

## Accessibility

- Follows [U.S. Web Design System (USWDS)](https://designsystem.digital.gov/components/accordion/)
  guidelines:
  - Use the `button` HTML element for screenreaders and keyboards.
  - Use the `aria-expanded` attribute to indicate whether the `Accordion` is
    expanded (`true`) or collapsed (`false`).
  - Use the `aria-controls` attribute to associate the control with the panel.
- Deviates from USWDS in that the user can open multiple panels. Opening one,
  does not collapse already expanded panel.
- The open and close icons are decorative (`aria-hidden` is `true`).
- Visible focus goes around full button and full button is clickable

Resources:

- [W3C WAI-Aria Practices - Accordion](https://www.w3.org/TR/wai-aria-practices-1.1/#accordion)
- [USWDS Accordion](https://designsystem.digital.gov/components/accordion/)
- [Chakra Accordion](https://chakra-ui.com/docs/components/disclosure/accordion)

## FAQ Example

export const faqContent = [
  {
    label: "Tom Nook",
    panel: (
      <Card
        layout={CardLayouts.Row}
        center
        imageSrc="https://play.nintendo.com/images/AC_Tom_FRYtwIN.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
        imageAlt="Alt text"
        imageAspectRatio={ImageRatios.TwoByOne}
      >
        <CardHeading level={HeadingLevels.Four} id="heading1-tom">
          Tom Nook
        </CardHeading>
        <CardContent>
          Tom Nook, <b>known in Japan as Tanukichi</b>, is a fictional character
          in the Animal Crossing series who operates the village store.
        </CardContent>
      </Card>
    ),
  },
  {
    label: "Isabelle",
    panel: (
      <Card
        layout={CardLayouts.Row}
        center
        imageSrc="https://play.nintendo.com/images/AC_Isabelle_7XU6aGu.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
        imageAlt="Alt text"
        imageAspectRatio={ImageRatios.TwoByOne}
      >
        <CardHeading level={HeadingLevels.Four} id="heading1-isabelle">
          Isabelle
        </CardHeading>
        <CardContent>
          Isabelle, known as Shizue in Japan, is a fictional character from the
          Animal Crossing series of video games. She is a kindly Shih Tzu that
          debuted in the 2012 release Animal Crossing: New Leaf, where she
          serves as the secretary to the player character.
        </CardContent>
      </Card>
    ),
  },
  {
    label: "K.K. Slider",
    panel: (
      <Card
        layout={CardLayouts.Row}
        center
        imageSrc="https://play.nintendo.com/images/AC_KK_jh4yj5t.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
        imageAlt="Alt text"
        imageAspectRatio={ImageRatios.TwoByOne}
      >
        <CardHeading level={HeadingLevels.Four} id="heading1-kkslider">
          K.K. Slider
        </CardHeading>
        <CardContent>
          <p>
            Totakeke, more commonly known as <b>K.K. Slider or K.K.</b>, is a
            fictional character within the Animal Crossing franchise. One of the
            franchise's most popular characters, he debuted in the title Animal
            Crossing, and has appeared in every installment since.
          </p>
        </CardContent>
      </Card>
    ),
  },
];

Building out FAQ-like accordions happens automatically when there are more than
one object in the array passed into the `contentData` prop.

<Canvas withToolbar>
  <Story name="FAQ Example">
    <Accordion contentData={faqContent} />
  </Story>
</Canvas>

```jsx
export const faqContent = [
  {
    label: "Tom Nook",
    panel: (
      <Card
        layout={CardLayouts.Row}
        center
        imageSrc="https://play.nintendo.com/images/AC_Tom_FRYtwIN.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
        imageAlt="Alt text"
        imageAspectRatio={ImageRatios.TwoByOne}
      >
        <CardHeading level={HeadingLevels.Four} id="heading1-tom">
          Tom Nook
        </CardHeading>
        <CardContent>
          Tom Nook, <b>known in Japan as Tanukichi</b>, is a fictional character
          in the Animal Crossing series who operates the village store.
        </CardContent>
      </Card>
    ),
  },
  {
    label: "Isabelle",
    panel: (
      <Card
        layout={CardLayouts.Row}
        center
        imageSrc="https://play.nintendo.com/images/AC_Isabelle_7XU6aGu.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
        imageAlt="Alt text"
        imageAspectRatio={ImageRatios.TwoByOne}
      >
        <CardHeading level={HeadingLevels.Four} id="heading1-isabelle">
          Isabelle
        </CardHeading>
        <CardContent>
          Isabelle, known as Shizue in Japan, is a fictional character from the
          Animal Crossing series of video games. She is a kindly Shih Tzu that
          debuted in the 2012 release Animal Crossing: New Leaf, where she
          serves as the secretary to the player character.
        </CardContent>
      </Card>
    ),
  },
  {
    label: "K.K. Slider",
    panel: (
      <Card
        layout={CardLayouts.Row}
        center
        imageSrc="https://play.nintendo.com/images/AC_KK_jh4yj5t.17345b1513ac044897cfc243542899dce541e8dc.9afde10b.png"
        imageAlt="Alt text"
        imageAspectRatio={ImageRatios.TwoByOne}
      >
        <CardHeading level={HeadingLevels.Four} id="heading1-kkslider">
          K.K. Slider
        </CardHeading>
        <CardContent>
          <p>
            Totakeke, more commonly known as <b>K.K. Slider or K.K.</b>, is a
            fictional character within the Animal Crossing franchise. One of the
            franchise's most popular characters, he debuted in the title Animal
            Crossing, and has appeared in every installment since.
          </p>
        </CardContent>
      </Card>
    ),
  },
];

...

<Accordion contentData={faqContent} />
```
