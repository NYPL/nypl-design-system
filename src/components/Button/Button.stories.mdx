import { ButtonGroup, VStack } from "@chakra-ui/react";
import {
  ArgsTable,
  Canvas,
  Description,
  Meta,
  Story,
} from "@storybook/addon-docs";
import { withDesign } from "storybook-addon-designs";

import Button, { ButtonElementType } from "./Button";
import { ButtonTypes } from "./ButtonTypes";
import Icon from "../Icons/Icon";
import {
  IconAlign,
  IconNames,
  IconRotationTypes,
  IconSizes,
} from "../Icons/IconTypes";
import { getCategory } from "../../utils/componentCategories";
import DSProvider from "../../theme/provider";
import { getStorybookEnumValues } from "../../utils/utils";

export const enumValues = getStorybookEnumValues(ButtonTypes, "ButtonTypes");

<Meta
  title={getCategory("Button")}
  component={Button}
  decorators={[withDesign]}
  parameters={{
    design: {
      type: "figma",
      url: "https://www.figma.com/file/qShodlfNCJHb8n03IFyApM/Master?node-id=11477%3A2298",
    },
    jest: ["Button.test.tsx"],
  }}
  argTypes={{
    additionalStyles: { control: false },
    attributes: { control: false },
    buttonText: { description: "Only used for Storybook" },
    buttonType: {
      control: { type: "select" },
      table: { defaultValue: { summary: "ButtonType.Primary" } },
      options: enumValues.options,
    },
    className: { control: false },
    displayIcon: { description: "Only used for Storybook." },
    displayIconLeft: {
      description: "Move the icon left or right. Only used for Storybook.",
    },
    iconType: {
      control: { type: "select" },
      options: Object.values(IconNames).map((value) => value),
      description: "Select the icon. Only used for Storybook.",
    },
    id: { control: false },
    isDisabled: { table: { defaultValue: { summary: false } } },
    mouseDown: { table: { defaultValue: { summary: false } } },
    onClick: { control: false },
  }}
/>

# Button

| Component Version | DS Version |
| ----------------- | ---------- |
| Added             | `0.0.4`    |
| Latest            | `0.25.9`   |

<Description of={Button} />

Update the `buttonType` in the Controls section to see the types of buttons
that can be rendered.

- `ButtonTypes.Primary` is used for actions that move the user forward.
- `ButtonTypes.Secondary` is used for actions that move the user back, such as cancellations.
- `ButtonTypes.Callout` is used for call to action text such as "Donate".
- `ButtonTypes.Pill` is used for equally weighted actions within cards and always in a set.
- `ButtonTypes.Link` is used for equally weighted actions in a text based list.
- `ButtonTypes.NoBrand` is a variant used when there is no brand and will display
  the background color as black.

When one and only one `Icon` component is passed inside a `Button` component with
no text, it will automatically be configured to use the `"iconOnly"` type.

<Canvas withToolbar>
  <Story
    name="Button with Controls"
    args={{
      additionalStyles: undefined,
      attributes: undefined,
      buttonText: "Button Text",
      buttonType: "ButtonTypes.Primary",
      className: undefined,
      displayIcon: false,
      displayIconLeft: true,
      iconType: IconNames.Search,
      id: "button-id",
      isDisabled: false,
      mouseDown: undefined,
      onClick: undefined,
      type: "button",
    }}
  >
    {(args) => (
      <Button {...args} buttonType={enumValues.getValue(args.buttonType)}>
        {args.displayIcon && args.displayIconLeft && (
          <Icon
            name={args.iconType}
            align={IconAlign.Left}
            size={IconSizes.Small}
          />
        )}
        {args.buttonText}
        {args.displayIcon && !args.displayIconLeft && (
          <Icon
            name={args.iconType}
            align={IconAlign.Right}
            size={IconSizes.Small}
          />
        )}
      </Button>
    )}
  </Story>
</Canvas>

<ArgsTable story="Button with Controls" />

## Button Groups

Primary and secondary buttons should be grouped like in the following example.
The `ButtonGroup` component, which is directly exported from Chakra UI, should
be used to wrap the `Button` component.

<Canvas>
  <Story name="Button Groups">
    <ButtonGroup>
      <Button buttonType={ButtonTypes.Secondary}>Button</Button>
      <Button buttonType={ButtonTypes.Primary}>Submit</Button>
    </ButtonGroup>
  </Story>
</Canvas>

## With Icons

The `Icon` component collaborates great with the `Button` component. Check out
[`src/components/Icons/IconTypes`](https://github.com/NYPL/nypl-design-system/blob/development/src/components/Icons/IconTypes.tsx)
to see the full list of icon and logo names that can be rendered.

<Canvas>
  <Story name="With Icon">
    <VStack align="left" spacing="input.group.button.vstack" width="150px">
      <Button>
        <Icon
          name={IconNames.Search}
          align={IconAlign.Left}
          size={IconSizes.Small}
        />
        Button Text
      </Button>
      <Button>
        Button Text
        <Icon
          name={IconNames.Search}
          align={IconAlign.Right}
          size={IconSizes.Small}
        />
      </Button>
    </VStack>
  </Story>
</Canvas>

The icon can be placed to the left or the right of the button text.

<Canvas>
  <DSProvider>
    <ButtonGroup>
      <Button buttonType={ButtonTypes.Secondary}>
        <Icon
          name={IconNames.Arrow}
          iconRotation={IconRotationTypes.Rotate90}
          align={IconAlign.Left}
          size={IconSizes.Small}
        />
        Previous
      </Button>
      <Button buttonType={ButtonTypes.Secondary}>
        Next
        <Icon
          name={IconNames.Arrow}
          iconRotation={IconRotationTypes.Rotate270}
          align={IconAlign.Right}
          size={IconSizes.Small}
        />
      </Button>
    </ButtonGroup>
  </DSProvider>
</Canvas>

Text in a button is optional if an icon is rendered, but make sure that there
is an `aria-label` passed to the `Button` component through the `attributes` prop:
`attributes={{ "aria-label": "Previous" }}`

<Canvas>
  <DSProvider>
    <ButtonGroup>
      <Button
        buttonType={ButtonTypes.Secondary}
        attributes={{
          "aria-label": "Previous",
        }}
      >
        <Icon
          name={IconNames.Arrow}
          iconRotation={IconRotationTypes.Rotate90}
          size={IconSizes.Small}
        />
      </Button>
      <Button
        buttonType={ButtonTypes.Secondary}
        attributes={{
          "aria-label": "Next",
        }}
      >
        <Icon
          name={IconNames.Arrow}
          iconRotation={IconRotationTypes.Rotate270}
          size={IconSizes.Small}
        />
      </Button>
      <Button
        buttonType={ButtonTypes.Secondary}
        attributes={{
          "aria-label": "Close",
        }}
      >
        <Icon name={IconNames.Close} size={IconSizes.Small} />
      </Button>
    </ButtonGroup>
  </DSProvider>
</Canvas>

## Patterns

Buttons are blue by default but should be red when it is intended to be used as
a call out. The "Back to Top" button must be of `ButtonTypes` `Secondary` and
must include an up arrow icon on the right side.

<Canvas>
  <Story name="Patterns">
    <ButtonGroup>
      <Button buttonType={ButtonTypes.Callout}>Donate to this library</Button>
      <Button buttonType={ButtonTypes.Secondary}>
        Back to Top
        <Icon
          name={IconNames.Arrow}
          iconRotation={IconRotationTypes.Rotate180}
          size={IconSizes.Small}
          className="right"
          align={IconAlign.Right}
        />
      </Button>
    </ButtonGroup>
  </Story>
</Canvas>

## Other Examples

The different `ButtonTypes` modified by the `buttonType` prop:

<Canvas>
  <DSProvider>
    <ButtonGroup>
      <Button buttonType={ButtonTypes.Primary}>Primary</Button>
      <Button buttonType={ButtonTypes.Secondary}>Secondary</Button>
      <Button buttonType={ButtonTypes.Callout}>Callout</Button>
      <Button buttonType={ButtonTypes.Pill}>Pill</Button>
      <Button buttonType={ButtonTypes.Link}>Link</Button>
      <Button buttonType={ButtonTypes.NoBrand}>NoBrand</Button>
    </ButtonGroup>
  </DSProvider>
</Canvas>

Modifying the `isDisabled` prop:

<Canvas>
  <DSProvider>
    <ButtonGroup>
      <Button isDisabled={false}>Enabled</Button>
      <Button isDisabled>isDisabled</Button>
    </ButtonGroup>
  </DSProvider>
</Canvas>
