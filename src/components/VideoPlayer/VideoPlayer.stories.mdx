import { action } from "@storybook/addon-actions";
import {
  ArgsTable,
  Canvas,
  Description,
  Meta,
  Story,
} from "@storybook/addon-docs";
import { withDesign } from "storybook-addon-designs";

import VideoPlayer from "./VideoPlayer";
import { VideoPlayerAspectRatios, VideoPlayerTypes } from "./VideoPlayerTypes";
import { getCategory } from "../../utils/componentCategories";
import DSProvider from "../../theme/provider";
import { getStorybookEnumValues } from "../../utils/utils";

export const ratiosEnumValues = getStorybookEnumValues(
  VideoPlayerAspectRatios,
  "VideoPlayerAspectRatios"
);
export const typesEnumValues = getStorybookEnumValues(
  VideoPlayerTypes,
  "VideoPlayerTypes"
);

<Meta
  title={getCategory("VideoPlayer")}
  component={VideoPlayer}
  decorators={[withDesign]}
  parameters={{
    design: {
      type: "figma",
      url:
        "https://www.figma.com/file/qShodlfNCJHb8n03IFyApM/Main?node-id=10968%3A3680",
    },
    jest: ["VideoPlayer.test.tsx"],
  }}
  argTypes={{
    attributes: { control: false },
    className: { control: false },
    id: { control: false },
  }}
/>

# Video Player

| Component Version | DS Version |
| ----------------- | ---------- |
| Added             | `0.23.2`   |
| Latest            | `0.25.2`   |

<Description of={VideoPlayer} />

The `VideoPlayer` component is used to embed a `Vimeo` or `YouTube` video player on a page. The component requires both the `videoType` and `videoId` props. You can extract the videoId from the video's URL. **IMPORTANT:** Do not try to enter the full video URL as the `videoId` value.

The `aspectRatio` prop is used to control the sizing of the space allotted for the video rendering. Ultimately, the `aspectRatio` prop should be set to match the aspect ratio of the video that is being rendered. The default aspect ratio is `16:9`.

<Canvas withToolbar>
  <Story
    name="VideoPlayer"
    args={{
      aspectRatio: "VideoPlayerAspectRatios.FourByThree",
      descriptionText:
        "Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.",
      headingText: "NYPL Video",
      helperText:
        "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor.",
      videoId: "",
      videoType: "VideoPlayerTypes.Vimeo",
    }}
    argTypes={{
      aspectRatio: {
        control: { type: "select" },
        options: ratiosEnumValues.options,
      },
      showHelperInvalidText: {
        table: { defaultValue: { summary: true } },
      },
      videoType: {
        control: { type: "select" },
        options: typesEnumValues.options,
      },
    }}
  >
    {(args) => (
      <VideoPlayer
        {...args}
        aspectRatio={ratiosEnumValues.getValue(args.aspectRatio)}
        videoId={
          args.videoType === "VideoPlayerTypes.Vimeo"
            ? args.videoId || "474719268"
            : args.videoId || "nm-dD2tx6bk"
        }
        videoType={typesEnumValues.getValue(args.videoType)}
      />
    )}
  </Story>
</Canvas>

<ArgsTable story="VideoPlayer" />

**Example Vimeo IDs:** `474719268`, `491405018`, `493795778` (square)<br />
**Example YouTube IDs:** `PfqgDG1qrKg`, `roi5V8ppi7Y`, `nm-dD2tx6bk`

## Extracting Video IDs

### Vimeo

```
https://vimeo.com/[VIDEO_ID]
https://vimeo.com/474719268
```

### YouTube

```
https://www.youtube.com/watch?v=[VIDEO_ID]
https://www.youtube.com/watch?v=nm-dD2tx6bk
```

## Errored

If the necessary props are not passed to the `VideoPlayer` component, the component UI will display an error message.

<Canvas>
  <DSProvider>
    <VideoPlayer
      type={VideoPlayerTypes.Vimeo}
      videoId="https://vimeo.com/474719268"
    />
  </DSProvider>
</Canvas>
