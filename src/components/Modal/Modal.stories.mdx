import { ButtonGroup } from "@chakra-ui/react";
import {
  ArgsTable,
  Canvas,
  Description,
  Meta,
  Story,
} from "@storybook/addon-docs";
import { useState } from "react";

import { ModalTrigger, useModal } from "./Modal";
import Button from "../Button/Button";
import { ButtonTypes } from "../Button/ButtonTypes";
import { getCategory } from "../../utils/componentCategories";

<Meta
  title={getCategory("Modal")}
  component={Modal}
  parameters={{
    jest: ["Modal.test.tsx"],
  }}
/>

# Modal

| Component Version | DS Version |
| ----------------- | ---------- |
| Added             | `0.1.0`    |
| Latest            | `0.27.0`   |

## Table of Contents

- [Overview](#overview)
- [Accessibility](#accessibility)
- [ModalTrigger](#modaltrigger)
- [ModalTrigger Component Props](#modaltrigger-component-props)
- [useModal](#usemodal)
- [useModal Component Props](#usemodal-component-props)

## Overview

_Note: This component is going through an accessibility review and is not
recommended for use until it is updated._

<Description of={Modal} />

## Accessibility

TBD

## ModalTrigger

This DS `ModalTrigger` component renders a button that you click to open the
modal.

```jsx
import { ModalTrigger } from "@nypl/design-system-react-components";

//...
<ModalTrigger
  buttonText="Button Text"
  id="modal-trigger"
  modalProps={{
    bodyContent="body text"
    closeButtonLabel="Close Button"
    headingText="Modal Heading Text"
    onClose={() => {
      console.log("custom close");
    }}
  }}
/>;
```

## ModalTrigger Component Props

<Canvas withToolbar>
  <Story
    name="ModalTrigger"
    args={{
      buttonText: "Button Text",
      id: "modal-trigger",
      modalProps: {
        bodyContent: "body text",
        closeButtonLabel: "Close Button",
        headingText: "Modal Heading Text",
        onClose: () => {
          console.log("custom close");
        },
      },
    }}
  >
    {(args) => <ModalTrigger {...args} />}
  </Story>
</Canvas>

<ArgsTable story="ModalTrigger" />

## useModal

This hook function can be used to render just the Chakra UI `Modal` component
with a custom open button and optional custom close buttons. You must render
your own button and pass the appropriate `onOpen` handler for the modal to open.

You can retrieve the DS `Modal` component and the `onOpen` and `onClose` function
handlers when calling the `useModal` function. The `onOpen` function handler is
used to open the `Modal` React component. This function can be passed to any
number of elements that use the `onClick` attribute. The `onClose` function can
be used on any element that uses the `onClick` attribute.

**NOTE: in this case, the `buttonText` prop is not necessary since you have to
create and render your own button.**

```jsx
import { useModal } from "@nypl/design-system-react-components";

// ...
export const ModalStory = (args) => {
  const { onClose, onOpen, Modal } = useModal();
  const modalProps = {
    bodyContent: (
      <>
        <Button id="custom-close" onClick={onClose}>
          Go back
        </Button>
        <p>This is the body content.</p>
        <Button id="custom-close2" onClick={onClose}>
          This is a custom close button.
        </Button>
      </>
    ),
    closeButtonLabel: "Close Button",
    headingText: "Modal Heading Text",
    onClose: () => {
      console.log("custom close");
      onClose();
    },
  };
  return (
    <>
      <ButtonGroup>
        <Button id="1" onClick={onOpen}>
          Open Modal
        </Button>
        <Button buttonType={ButtonTypes.Secondary} id="2" onClick={onOpen}>
          I can open the modal, too
        </Button>
      </ButtonGroup>
      <div onClick={onOpen}>
        I'm just a div and shouldn't be used in production but this is just an
        example
      </div>
      <Modal {...modalProps} />
    </>
  );
};
```

export const ModalStory = (args) => {
  const { onClose, onOpen, Modal } = useModal();
  const modalProps = {
    bodyContent: (
      <>
        <Button id="custom-close" onClick={onClose}>
          Go back
        </Button>
        <p>This is the body content.</p>
        <Button id="custom-close2" onClick={onClose}>
          This is a custom close button.
        </Button>
      </>
    ),
    closeButtonLabel: "Close Button",
    headingText: "Modal Heading Text",
    onClose: () => {
      console.log("custom close");
      onClose();
    },
  };
  return (
    <>
      <ButtonGroup>
        <Button id="1" onClick={onOpen}>
          Open Modal
        </Button>
        <Button buttonType={ButtonTypes.Secondary} id="2" onClick={onOpen}>
          I can open the modal, too
        </Button>
      </ButtonGroup>
      <div onClick={onOpen}>
        I'm just a div and shouldn't be used in production but this is just an
        example
      </div>
      <Modal {...modalProps} />
    </>
  );
};

## useModal Component Props

<Canvas withToolbar>
  <Story name="Modal">
    <ModalStory />
  </Story>
</Canvas>

<ArgsTable story="Modal" />
