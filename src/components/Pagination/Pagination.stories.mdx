import {
  ArgsTable,
  Canvas,
  Description,
  Meta,
  Story,
} from "@storybook/addon-docs";
import { withDesign } from "storybook-addon-designs";
import { withQuery } from "@storybook/addon-queryparams";

import Pagination from "./Pagination";
import { getCategory } from "../../utils/componentCategories";
import { getStorybookHrefProps } from "../../utils/utils";

export const hrefProps = getStorybookHrefProps(10);

<Meta
  title={getCategory("Pagination")}
  component={Pagination}
  decorators={[withDesign, withQuery]}
  parameters={{
    design: {
      type: "figma",
      url: "https://www.figma.com/file/qShodlfNCJHb8n03IFyApM/Master?node-id=17226%3A932",
    },
    jest: ["Pagination.test.tsx"],
  }}
  argTypes={{
    className: { control: false },
    getPageHref: { control: false },
    id: { control: false },
    currentPage: { table: { defaultValue: { summary: 1 } } },
    onPageChange: { control: false },
  }}
/>

# Pagination

| Component Version | DS Version |
| ----------------- | ---------- |
| Added             | `0.0.10`   |
| Latest            | `0.25.10`  |

<Description of={Pagination} />

The `Pagination` component helps navigate between pages of a multi-page
application. It is commonly used on a search results page. Update the `pageCount`
prop in the Controls to explore this component with many or few pages.

Pagination uses anchor tags because it is navigating between URLs.

## Pagination with URL Updates

In order to update the URL with a query parameter, the parent component must
declare and pass a `getPageHref` function to the `Pagination` component. This
function takes a `selectedPage` number argument for the selected page and it
should return a string with the desired URL that the pagination links should go
to. Note that this will refresh the browser on every click.

In the following example, the `getPageHref` function will compute a new URL that
has `&page=` as a URL query. In your own application this query parameter can be
named anything but you have to pick up the value in the wrapper component.

```tsx
// Example in a search results page.
const getPageHref = (selectedPage: number) => {
  // This should be updated for your router system, if any, including the
  // base or origin URL.
  return `${location.origin}?q=celeste&page=${selectedPage}`;
};
```

<Canvas withToolbar>
  <Story
    name="Pagination with URL Updates"
    args={{
      className: undefined,
      getPageHref: hrefProps.getPageHref,
      id: "pagination-id",
      currentPage: hrefProps.computedCurrentPage || 1,
      pageCount: 10,
    }}
  >
    {(args) => <Pagination {...args} />}
  </Story>
</Canvas>

<ArgsTable story="Pagination with URL Updates" />

## Pagination with Unchanging URL

It is preferred to use the `Pagination` component with the `getPageHref`
function passed as a prop and that the URL is updated whenever a page is
changed. However,Ã¥ the optional `onPageChange` prop is available in case URL
updating is not desired.

In the following example, the `onPageChange` function gets the current page as
its only function argument. This is computed internally in the `Pagination`
component through its own state.

```tsx
// Example in a search results page.
const onPageChange = (currentPage: number) => {
  console.log(`Current page: ${currentPage}`);
  // Do what you need to with the `currentPage` value.
};
```

<Canvas withToolbar>
  <Story
    name="Pagination with Unchanging URL"
    args={{
      className: undefined,
      id: "pagination-id-2",
      currentPage: 7,
      onPageChange: (currentPage) => {
        console.log(`Current page: ${currentPage}`);
      },
      pageCount: 100,
    }}
  >
    {(args) => <Pagination {...args} />}
  </Story>
</Canvas>
