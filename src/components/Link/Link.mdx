import { Box } from "@chakra-ui/react";
import { ArgTypes, Canvas, Description, Meta, Source } from "@storybook/blocks";
import { cloneElement } from "react";
import { changelogData } from "./linkChangelogData";

import ComponentChangelogTable from "../../utils/ComponentChangelogTable";
import Link from "./Link";
import Icon from "../Icons/Icon";
import * as LinkStories from "./Link.stories";

<Meta of={LinkStories} />

# Link

| Component Version | DS Version   |
| ----------------- | ------------ |
| Added             | `0.0.4`      |
| Latest            | `Prerelease` |

## Table of Contents

- {<Link href="#overview" target="_self">Overview</Link>}
- {<Link href="#component-props" target="_self">Component Props</Link>}
- {<Link href="#accessibility" target="_self">Accessibility</Link>}
- {<Link href="#all-link-types" target="_self">All Link Types</Link>}
- {<Link href="#links-with-icons" target="_self">Links With Icons</Link>}
- {<Link href="#anchor-element-rendering" target="_self">Anchor Element Rendering</Link>}
- {<Link href="#link-with-routers" target="_self">Link with Routers</Link>}
- {<Link href="#changelog" target="_self">Changelog</Link>}

## Overview

<Description of={LinkStories} />

## Component Props

<Canvas of={LinkStories.WithControls} />

<ArgTypes of={LinkStories.WithControls} />

## Accessibility

The `Link` component renders an `<a>` element with the `href` attribute, so the
`Link` component should be used for navigation. If an `onClick` action is
required, a `Button` component should be used instead. In simple terms, a link
goes somewhere and a button does something.

Despite these best practices and recommendations, it is possible to pass an
`onClick` prop to the `Link` component because there are some very specific use
cases within NYPL web apps that require this. Additionally, the `onclick`
attribute (intentially all lowercase) is a native HTML pattern that is allowed.
Having said that, **you are highly urged to not use the `onClick` prop unless
you know what you are doing**.

The `"external"` variant of the `Link` component includes `"screen reader only"`
descriptive text to clarify that the link will open in a new tab/window.
Additionally it renders with the `rel` attribute containing
the relation names "nofollow", "noopener" and "noreferrer".

<Canvas of={LinkStories.Accessibility} />

The `Link` component also has a `screenreaderOnlyText` prop that can be used to
add additional text to the link that is only visible to screen readers. This can
be used to provide additional context to the link when the text is short, such
as visible "Read more..." text.

For details about NYPL link patterns, refer to the [Links Accessibility
Guide](/?path=/docs/accessibility-guide-links--docs).

Resources:

- [W3C WAI Link Examples](https://www.w3.org/TR/wai-aria-practices-1.1/examples/link/link.html)
- [Yale Usability & Web Accessibility Links](https://usability.yale.edu/web-accessibility/articles/links)
- [WebAIM: Invisible Content Just for Screen Reader Users](https://webaim.org/techniques/css/invisiblecontent/)
- [IANA: Link Relation Types](https://www.iana.org/assignments/link-relations/link-relations.xhtml)

## All Link Types

The `Link` component offers multiple variants for differing UX situations.

Use the `default` and `action` variants for text links that sit within a block
of plain (unlinked) text — a paragraph, a single sentence, or even just a few
words — and point to other pages within the current website.

Use the `external` variant for text links that sit within a block of plain
(unlinked) text and point to something outside the current website. This variant
will open a new browser tab by default.

Use the `standalone` variant for text links that sit alone within the page
content area. For example, a Read More link at the end of a short description or
a View In Catalog link on a book detail page. The `backawards` and `forwards`
variants should be used for specific situations when navigating through a series
or related pages.

Use the button variants when a link needs to be highlighted or emphasized within
a CTA element. For example, a link to a book detail page from cards within a
search results set. Please note that the actual `button` variant has been
deprecated.

IMPORTANT: Links that look like buttons should still act like links and not act
like buttons. Refer to the <Link href="#accessibility"
target="_self">Accessibility</Link> section above for clarification.

<Canvas of={LinkStories.AllLinkTypes} />

## Links With Icons

To render an `Icon` as part of the link, make sure that the `Link` component
wraps the `Icon`. Use `type="action"` to apply appropriate styling to
links with icons. Icons can be rendered to the left or right of the link text.

<Canvas of={LinkStories.LinksWithIcons} />

## Anchor Element Rendering

`Link` can wrap an existing `<a>` element (and `Icon` component) or it
can use the `href` prop to generate an `<a>` element.

<Source
  code={`
// Existing anchor element
<Link type="action">
  <a href="#existing-anchor-tag">link</a>
</Link>
// ...
// Also works with an icon component. Make sure to wrap the icon and anchor
// in a single element for this pattern.
<Link type="action">
  <>
    <Icon name="check" align="left" size="small" />
    <a href="#existing-anchor-tag">check link</a>
  </>
</Link>
// ...
// Otherwise, the \`href\` prop will generate an \`<a>\` tag.
<Link type="action" href="#passed-in-link">
  link
</Link>
`}
  language="jsx"
/>

{

<>
  This is a{" "}
  <Link type="action">
    <a href="#existing-anchor-tag">link</a>
  </Link>{" "}
  with the &lt;a&gt; element as a child of the `Link` component. This is a{" "}
  <Link type="action" href="#passed-in-link">
    link
  </Link>{" "}
  where the `Link` component uses the `href` prop and has a string-only child.
  Finally, this is a{" "}
  <Link type="action">
    <>
      <Icon name="check" align="left" size="small" />
      <a href="#existing-anchor-tag">link</a>
    </>
  </Link>{" "}
  with a check icon.
  <Box mb="20px"></Box>
</>
}

## Link with Routers

### React Router

The Design System's `Link` component should wrap around `react-router`'s own
`Link` component. To avoid name conflicts, rename either the Design System's
or `react-router`'s `Link` component. Any of the following patterns are valid.

<Source
  code={`
// In this first example, React Router's \`Link\` component
// is renamed as \`ReactRouterLink\`.
import {
  BrowserRouter as Router,
  Link as ReactRouterLink,
} from "react-router-dom";
import { Link } from "@nypl/design-system-react-components";
// ...
<Link type="action">
  <ReactRouterLink to="#">Next Page</ReactRouterLink>
</Link>;
`}
  language="jsx"
/>

<Source
  code={`
// In this second example, React Router's \`Link\` component
// is not renamed but the DS's \`Link\` component is renamed
// to \`DSLink\`.
import { BrowserRouter, Link } from "react-router-dom";
import { Link as DSLink } from "@nypl/design-system-react-components";
// ...
<DSLink type="action">
  <Link to="#">Next Page</Link>
</DSLink>;
`}
  language="jsx"
/>

<Source
  code={`
// In this third example, React Router's \`Link\` component
// is not renamed and the DS's \`Link\` component is
// imported and rendered as \`DS.Link\`.
import { BrowserRouter, Link } from "react-router-dom";
import DS from "@nypl/design-system-react-components";
// ...
<DS.Link type="action">
  <Link to="#">Next Page</Link>
</DS.Link>;
`}
  language="jsx"
/>

### NextJS

NextJS's `Link` component should wrap the Design System's `Link` component.
The `href` and `passHref` props MUST be passed into NextJS' `Link` component.
These props, along with an implicit `ref` from NextJS and the Design System's
`Link` component `forwardRef` implementation, handle correctly routing between
pages in a NextJS app.

<Source
  code={`
import { Link } from "@nypl/design-system-react-components";
// ...
/**
 * This is just an example wrapper that works similarly to NextJS' \`Link\`
 * component. In real life, NextJS's \`Link\` component will pass down the
 * \`href\` and \`passHref\` props and a \`ref\` to make routing functional.
 */
export const NextJsLink = (props: HTMLAnchorElement) =>
  React.cloneElement(
    props.children,
    { ...props },
    props.children.props.children
  );
// ...
// Note that NextJS' \`href\` and \`passHref\` props are required.
<NextJsLink href="#" passHref>
  <Link type="action">Next Page</Link>
</NextJsLink>;
`}
  language="jsx"
/>

## Changelog

<ComponentChangelogTable changelogData={changelogData} />
