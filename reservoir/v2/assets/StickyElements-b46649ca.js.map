{"version":3,"file":"StickyElements-b46649ca.js","sources":["../../../src/components/AccessibilityGuide/StickyElements.mdx"],"sourcesContent":["import { Meta, Source } from \"@storybook/blocks\";\n\nimport Link from \"../Link/Link\";\n\n<Meta title=\"Accessibility Guide/Sticky Elements\" />\n\n# Sticky Elements\n\n## Table of Contents\n\n- {<Link href=\"#general-information\" target=\"_self\">General Information</Link>}\n- {<Link href=\"#NYPL-patterns\" target=\"_self\">NYPL Patterns</Link>}\n- {<Link href=\"#general-issues\" target=\"_self\">General Issues</Link>}\n- {<Link href=\"#implementation\" target=\"_self\">Implementation</Link>}\n- {<Link href=\"#resources\" target=\"_self\">Resources</Link>}\n\n## General Information\n\nSticky elements (`position: sticky`) switch between relative and fixed position. They move with the viewport as the user scrolls, so they are visible until they hit a given breakpoint.\n\nAvoid sticky elements in general. The most common use case, a sticky header, is only useful when users will be repeatedly accessing the menu and scrolling through multiple pages.\nThis is why you often see them used on e-commerce sites. If users don't need immediate navigation and will generally stay on one or two pages, a sticky header is unnecessary.\n\nAdditionally, sticky headers can obscure other elements on the page. For large menus that will cover parts of the page, consider an accordion or just making it fixed. This keeps the header in place\nat the top of the screen, so users will only need to cover part of the screen when they return to the header.\n\n## NYPL Patterns\n\nSticky elements should be used only for critical information that needs to remain visible, or to allow a continuous process for the user. For the new Digital Collections site, we chose to accept the shortcomings of the sticky header\nto maintain parity with the experience and feel of the old site.\n\n## General Issues\n\nWhen using a sticky element on a page, consider the following UX issues:\n\n- How much space is it taking up?\n- Is it difficult to access when tabbing forward and backwards?\n- Does it break when users zoom in on mobile devices?\n- Is it hiding focused elements?\n\nThe solution presented below only addresses the _last_ of these concerns: preventing a sticky\nheader from hiding focused elements.\n\n## Implementation\n\nSighted keyboard users tab through a page to display more content and to access buttons and links.\nTo return to the top of the page, keyboard users tab backwards. If the header on a page uses `position: sticky`,\ntabbing backwards moves the focused element underneath the header, so the user can no longer see where the focus is.\nA similar issue arises with users tabbing forwards against a sticky footer.\n\nThe apparent solution would be using `scroll-margin-top` to snap-scroll the viewport to wherever the focused\nelement is, but that's not supported on several major browsers.\n\nInstead, this approach uses a combination of CSS, HTML, and Typescript to check whether a focused element needs a sticky margin by\ndynamically calculating boundary interactions, then applies that margin (pushing page up) accordingly. This React hook is called by a\nfocus event on any page element or a ResizeObserver event on the sticky element.\n\nThis approach was first implemented with the Digital Collections header, using a [custom hook](https://github.com/NYPL/digital-collections/blob/main/src/hooks/useScrolled.ts) on the header.\n\nThis code can be modified to apply to any sticky element, alongside\n\n1. HTML data attributes on the sticky element, ex. `<header data-sticky-header> ... </header>`\n2. CSS: `position: sticky` on the sticky element\n\nThe hook first defines the `sticky` object:\n\n<Source\n  code={`\nlet sticky: {\n  header?: HTMLElement | null;\n  // Could have 'footer' as well here, for example.\n  offset?: number;\n} = {};\n`}\n/>\n`applyStickyMargin()` contains most of the logic, namely calculating boundary interactions\nbetween the sticky object and the focused object, then applying that margin accordingly:\n<Source\n  code={`\nconst applyStickyMargin = (sticky) => {\n  // Specifying which element on the page is focused, if none then defaulting to body.\n  const focused = (document.activeElement || document.body) as HTMLElement;\n  let applicable = focused !== document.body;\n  if (applicable && sticky.header) {\n    applicable = !sticky.header.contains(focused);\n  }\n  // Calculating difference between the edge of the header and the focused element.\n  if (applicable) {\n    const edge = {\n      header: sticky.header ? sticky.header.getBoundingClientRect().bottom + sticky.offset : 0,\n    };\n    const diff = sticky.header ? focused.getBoundingClientRect().top - edge.header : 0;\n  // Then scrolls window by that difference (plus a little padding).\n    if (diff < 0) {\n      window.scrollBy(0, diff - 10);\n    }\n  }\n};\n`}\n  language=\"tsx\"\n/>\n\nFor the complete code and more information, check out the [hook](https://github.com/NYPL/digital-collections/blob/main/src/hooks/useScrolled.ts) and its behavior on the [Digital Collections site](https://github.com/NYPL/digital-collections).\n\n## Resources\n\n- {<Link href=\"https://www.tpgi.com/prevent-focused-elements-from-being-obscured-by-sticky-headers/\">TPGi: Prevent focused elements from being obscured by sticky headers</Link>}\n  (This article is the source of the above approach, and this guide is pretty much an abridged summary of this article. Additionally, the code given here is Javascript and includes more sticky elements like a footer.)\n- {<Link href=\"https://www.smashingmagazine.com/2023/05/sticky-menus-ux-guidelines/\"> Designing Sticky Menus: UX Guidelines</Link>}\n- {<Link href=\"https://technology.blog.gov.uk/2018/05/21/sticky-elements-functionality-and-accessibility-testing/\">Sticky elements: functionality and accessibility testing</Link>}\n- {<Link href=\"https://design.gs.com/patterns/sticky-elements\">Sticky Elements</Link>}\n"],"names":["_createMdxContent","props","_components","_provideComponents","_jsxs","_Fragment","_jsx","Meta","Link","Source","MDXContent","MDXLayout"],"mappings":"8vBAKA,SAASA,EAAkBC,EAAO,CAChC,MAAMC,EAAc,OAAO,OAAO,CAChC,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,EAAG,IACH,KAAM,OACN,GAAI,KACJ,EAAG,IACH,GAAI,IACL,EAAEC,EAAoB,EAAEF,EAAM,UAAU,EACzC,OAAOG,EAAMC,EAAW,CACtB,SAAU,CAACC,EAAKC,EAAM,CACpB,MAAO,qCACR,CAAA,EAAG;AAAA,EAAMD,EAAKJ,EAAY,GAAI,CAC7B,GAAI,kBACJ,SAAU,iBACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,GAAI,oBACJ,SAAU,mBACX,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAME,EAAMF,EAAY,GAAI,CACrC,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,uBACN,OAAQ,QACR,SAAU,qBACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAMJ,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,iBACN,OAAQ,QACR,SAAU,eACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAMJ,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,kBACN,OAAQ,QACR,SAAU,gBACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAMJ,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,kBACN,OAAQ,QACR,SAAU,gBACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAMJ,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,aACN,OAAQ,QACR,SAAU,WACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAMF,EAAKJ,EAAY,GAAI,CAC7B,GAAI,sBACJ,SAAU,qBACX,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAAC,oBAAqBI,EAAKJ,EAAY,KAAM,CACrD,SAAU,kBACX,CAAA,EAAG,uJAAuJ,CAC5J,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,EAAG,CAC5B,SAAU;AAAA,+KACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,EAAG,CAC5B,SAAU;AAAA,8GACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,GAAI,gBACJ,SAAU,eACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,EAAG,CAC5B,SAAU;AAAA,iEACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,GAAI,iBACJ,SAAU,gBACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,EAAG,CAC5B,SAAU,0EACX,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CACpC,SAAU,iCACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,SAAU,+DACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,SAAU,qDACX,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,SAAU,gCACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAAC,mDAAoDI,EAAKJ,EAAY,GAAI,CAClF,SAAU,MACX,CAAA,EAAG;AAAA,qCAA+E,CACpF,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,GAAI,iBACJ,SAAU,gBACX,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAAC;AAAA,+FAAqMI,EAAKJ,EAAY,KAAM,CACrO,SAAU,kBACX,CAAA,EAAG;AAAA;AAAA,4EAAsM,CAC3M,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAAC,wCAAyCI,EAAKJ,EAAY,KAAM,CACzE,SAAU,mBACX,CAAA,EAAG;AAAA,gEAAuH,CAC5H,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,EAAG,CAC5B,SAAU;AAAA;AAAA,iFACX,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAAC,oFAAqFI,EAAKJ,EAAY,EAAG,CAClH,KAAM,iFACN,OAAQ,SACR,IAAK,+BACL,SAAU,aACX,CAAA,EAAG,iBAAiB,CACtB,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,EAAG,CAC5B,SAAU,qEACX,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAME,EAAMF,EAAY,GAAI,CACrC,SAAU,CAAC,mDAAoDI,EAAKJ,EAAY,KAAM,CACpF,SAAU,2CACpB,CAAS,CAAC,CACH,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC,QAASI,EAAKJ,EAAY,KAAM,CACzC,SAAU,kBACX,CAAA,EAAG,wBAAwB,CAC7B,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAAC,8BAA+BI,EAAKJ,EAAY,KAAM,CAC/D,SAAU,QACX,CAAA,EAAG,UAAU,CACpB,CAAK,EAAG;AAAA,EAAMI,EAAKG,EAAQ,CACrB,KAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAOP,CAAA,EAAG;AAAA,EAAML,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAACI,EAAKJ,EAAY,KAAM,CAChC,SAAU,qBACX,CAAA,EAAG;AAAA,yFAAiK,CAC3K,CAAK,EAAG;AAAA,EAAMI,EAAKG,EAAQ,CACrB,KAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBN,SAAU,KACX,CAAA,EAAG;AAAA,EAAML,EAAMF,EAAY,EAAG,CAC7B,SAAU,CAAC,6DAA8DI,EAAKJ,EAAY,EAAG,CAC3F,KAAM,iFACN,OAAQ,SACR,IAAK,+BACL,SAAU,MACX,CAAA,EAAG,4BAA6BI,EAAKJ,EAAY,EAAG,CACnD,KAAM,8CACN,OAAQ,SACR,IAAK,+BACL,SAAU,0BACX,CAAA,EAAG,GAAG,CACR,CAAA,EAAG;AAAA,EAAMI,EAAKJ,EAAY,GAAI,CAC7B,GAAI,YACJ,SAAU,WACX,CAAA,EAAG;AAAA,EAAME,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAME,EAAMF,EAAY,GAAI,CACrC,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,uFACN,SAAU,sEACpB,CAAS,EAAG;AAAA,EAAM,yNAAyN,CACpO,CAAA,EAAG;AAAA,EAAMJ,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,uEACN,SAAU,wCACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAMJ,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,qGACN,SAAU,0DACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,EAAMJ,EAAMF,EAAY,GAAI,CAC9B,SAAU,CAAC;AAAA,EAAMI,EAAKE,EAAM,CAC1B,KAAM,iDACN,SAAU,iBACX,CAAA,EAAG;AAAA,CAAI,CACT,CAAA,EAAG;AAAA,CAAI,CACd,CAAK,CAAC,CACN,CAAG,CACH,CACA,SAASE,EAAWT,EAAQ,GAAI,CAC9B,KAAM,CAAC,QAASU,CAAS,EAAI,OAAO,OAAO,CAAE,EAAER,EAAoB,EAAEF,EAAM,UAAU,EACrF,OAAOU,EAAYL,EAAKK,EAAW,OAAO,OAAO,CAAE,EAAEV,EAAO,CAC1D,SAAUK,EAAKN,EAAmBC,CAAK,CAC3C,CAAG,CAAC,EAAID,EAAkBC,CAAK,CAC/B"}