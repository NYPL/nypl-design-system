import{a as n,j as e,F as I}from"./emotion-react-jsx-runtime.browser.esm-49aea89b.js";import{r as l}from"./index-0cbcd92a.js";import{B as u}from"./Button-948e9be8.js";import{B as H}from"./ButtonGroup-c2c033a6.js";import{F as Te,a as f}from"./Form-b79b3734.js";import{I as M}from"./Icon-4eeffe51.js";import{L as Ve}from"./Link-24c1437a.js";import{N as Ie}from"./Notification-715070ee.js";import{R as N}from"./Radio-8cdc7037.js";import{R as Be}from"./RadioGroup-8ef77e28.js";import{T as b}from"./Text-d88b2f7a.js";import{u as K,T as Q}from"./TextInput-70995d87.js";import{u as Fe}from"./useNYPLBreakpoints-2881f83d.js";import{D as qe,g as Ee,c as De,e as Oe,b as Se}from"./chakra-ui-modal.esm-25230bce.js";import{a as We,u as Re,b as X,V as Ae,B as j}from"./chakra-ui-layout.esm-e0dbb94e.js";import{u as He}from"./chakra-ui-hooks.esm-539e7d47.js";const ee={category:"comment",comment:"",email:""};function Me(a,i){switch(i.type){case"category":return{...a,category:i.payload};case"comment":return{...a,comment:i.payload};case"email":return{...a,email:i.payload};case"clear":default:return ee}}function Ne(){const[a,i]=l.useReducer(Me,ee);return{state:a,setCategory:s=>i({type:"category",payload:s}),setComment:s=>i({type:"comment",payload:s}),setEmail:s=>i({type:"email",payload:s}),clearValues:()=>i({type:"clear"})}}const nt=["form","confirmation","error"],Z=We(l.forwardRef(({className:a,confirmationText:i,descriptionText:g,hiddenFields:B,id:o="feedbackbox",isInvalidComment:_=!1,isInvalidEmail:s=!1,notificationText:C,onSubmit:P,showCategoryField:F=!1,showEmailField:k=!1,title:q,view:v="form",isOpen:$,onOpen:U,onClose:L,...te},ne)=>{const[r,p]=K(v),[ie,E]=K(_),[d,D]=l.useState(!1),{state:x,setCategory:ae,setComment:oe,setEmail:re,clearValues:O}=Ne(),{isLargerThanMobile:le}=Fe(),S=He(),se=$||S.isOpen,de=U||S.onOpen,ce=L||S.onClose,h=l.useRef(),T=l.useRef(),V=l.useRef(),y=Re("FeedbackBox",{}),W=r==="form",me=r==="confirmation",R=r==="error",ue=3e3,z=500,fe=165,pe="auto 1fr",he=X(null,"dark.ui.typography.body"),ye=235,be=275,ge=345,xe=37,we=24;let c=fe;const w=()=>{ce(),p("form"),O(),E(!1),setTimeout(()=>{var t;(t=T==null?void 0:T.current)==null||t.focus()},250)},Ce=t=>{var J;t.preventDefault();let m={...x};if(B&&(m={...m,...B}),m.comment.length===0){(J=V==null?void 0:V.current)==null||J.focus(),E(!0);return}P&&P(m),E(!1),D(!0)},G=W&&C?e(Ie,{isCentered:!0,noMargin:!0,notificationContent:C,showIcon:!1,p:"0",sx:{"> div":{py:"xs"}},width:"100%"}):void 0,ke=X("ui.typography.heading","dark.ui.typography.heading"),Y=W&&g?e(b,{color:ke,fontWeight:"medium",noSpace:!0,children:g}):void 0,A=e(f,{children:e(Ve,{href:"https://www.nypl.org/help/about-nypl/legal-notices/privacy-policy",type:"external",fontSize:"text.tag",isUnderlined:!1,width:"fit-content",children:"Privacy Policy"})});l.useEffect(()=>{let t;return d&&(t=setTimeout(()=>{D(!1),p(R?"error":"confirmation"),O()},ue),v!==r&&(D(!1),p(v),clearTimeout(t))),()=>clearTimeout(t)},[O,R,d,p,v,r]),l.useEffect(()=>{let t;return(r==="error"||r==="confirmation")&&(t=setTimeout(()=>{var m;(m=h==null?void 0:h.current)==null||m.focus()},250)),()=>clearTimeout(t)},[h,r]),F&&(c=ye),k&&(c=be),F&&k&&(c=ge),C&&(c+=xe),g&&(c+=we),C&&g&&(c+=16);let ve=c+"px";return n(j,{className:a,id:o,ref:ne,sx:y,...te,children:[e(u,{id:"open",onClick:de,sx:y.openButton,ref:T,children:q}),n(qe,{blockScrollOnMount:!1,isOpen:se,onClose:w,placement:"bottom",children:[e(Se,{}),n(Ee,{sx:y.drawerContent,children:[n(u,{buttonType:"text",id:"close-btn",onClick:w,sx:y.closeButton,children:[e(M,{color:"ui.black",name:"minus",size:"medium"}),n("span",{children:["Close ",q]})]}),e(De,{sx:y.drawerHeader,children:e(b,{"data-testid":"title",children:q})}),e(Oe,{sx:y.drawerBody,children:n(Te,{gap:"grid.s",id:"feedback-form",onSubmit:Ce,sx:{".feedback-body":{alignItems:"flex-start",minHeight:ve,gridTemplateRows:pe},".feedback-body.response":{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center"}},children:[W&&n(I,{children:[n(Ae,{className:"feedback-body",spacing:"s",children:[(G||Y)&&n(I,{children:[G,Y]}),F&&e(f,{children:n(Be,{defaultValue:x.category,id:`${o}-category`,isDisabled:d,labelText:"What is your feedback about?",layout:le?"row":"column",name:`${o}-category`,onChange:t=>ae(t),children:[e(N,{id:"comment",labelText:"Comment",value:"comment"}),e(N,{id:"correction",labelText:"Correction",value:"correction"}),e(N,{id:"bug",labelText:"Bug",value:"bug"})]})}),e(f,{width:"100%",children:e(Q,{defaultValue:x.comment,helperText:`${z-x.comment.length} characters remaining`,id:`${o}-comment`,invalidText:"There was a problem. Please fill out this field.",isDisabled:d,isInvalid:ie,labelText:"Comment (Required)",maxLength:z,name:`${o}-comment`,onChange:t=>oe(t.target.value),placeholder:"Enter your question or feedback here",ref:V,type:"textarea"})}),k&&e(f,{width:"100%",children:e(Q,{id:`${o}-email`,invalidText:"There was a problem. Please enter a valid email address.",isDisabled:d,isInvalid:s,labelText:"Email",name:`${o}-email`,onChange:t=>re(t.target.value),placeholder:"Enter your email address here",type:"email",value:x.email})})]}),A,e(f,{children:n(H,{buttonWidth:"full",id:"submit-cancel",children:[e(u,{buttonType:"secondary",id:"cancel",isDisabled:d,onClick:w,children:"Cancel"},"cancel"),e(u,{id:"submit",isDisabled:d,type:"submit",children:"Submit"},"submit")]})})]}),me&&n(I,{children:[n(j,{className:"feedback-body response",margin:"auto",tabIndex:-1,textAlign:"center",ref:h,children:[e(M,{color:he,name:"actionCheckCircleFilled",size:"large"}),e(b,{fontWeight:"medium",children:"Thank you for submitting your feedback."}),k&&e(b,{children:"If you provided an email address and require a response, our service staff will reach out to you via email."}),i?e(b,{children:i}):void 0]},"confirmationWrapper"),A,e(f,{children:e(H,{buttonWidth:"full",id:"submit-cancel",children:e(u,{id:"return-browsing",buttonType:"secondary",onClick:w,children:"Return to Browsing"})})})]}),R&&n(I,{children:[n(j,{className:"feedback-body response",color:"ui.error.primary",margin:"auto",tabIndex:-1,textAlign:"center",ref:h,children:[e(M,{color:"ui.error.primary",name:"errorFilled",size:"large"}),e(b,{fontWeight:"medium",children:"Oops! Something went wrong. An error occured while processing your feedback."})]},"errorWrapper"),A,e(f,{children:n(H,{buttonWidth:"full",id:"submit-cancel",children:[e(u,{id:"return-browsing2",buttonType:"secondary",onClick:w,children:"Return to Browsing"},"return-browsing2"),e(u,{id:"try-again",onClick:()=>p("form"),children:"Try Again"},"try-again")]})})]})]})})]})]})]})}));try{Z.displayName="FeedbackBox",Z.__docgenInfo={description:"The `FeedbackBox` component renders a fixed-positioned button on the bottom\nright corner of a page that opens a Chakra `Drawer` popup component. Inside\nof the popup, a form is rendered with fields that allows users to provide\nfeedback. The `FeedbackBox` component does *not* call any API with the\nsubmitted data; that feature is the responsibility of the consuming\napplication.",displayName:"FeedbackBox",props:{title:{defaultValue:null,description:"Used to populate the label on the open button and the `Drawer`'s\nheader title.",name:"title",required:!0,type:{name:"string"}},view:{defaultValue:null,description:"Used to specify what screen should be displayed.",name:"view",required:!1,type:{name:'"form" | "confirmation" | "error"'}},className:{defaultValue:null,description:"Additional class name to add.",name:"className",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"ID that other components can cross reference for accessibility purposes",name:"id",required:!1,type:{name:"string"}},onSubmit:{defaultValue:null,description:"Callback function that will be invoked when the form is submitted.\nThe returned data object contains key/value pairs including the\nvalues from the `hiddenFields` prop.",name:"onSubmit",required:!0,type:{name:"(values: { [key: string]: string; }) => any"}},descriptionText:{defaultValue:null,description:`Used to add description text above the form input fields in
the initial/form view.`,name:"descriptionText",required:!1,type:{name:"string | Element"}},confirmationText:{defaultValue:null,description:`Used to add additional information to the default confirmation message in
the confirmation view.`,name:"confirmationText",required:!1,type:{name:"string | Element"}},isInvalidEmail:{defaultValue:null,description:"Toggles the invalid state for the email field.",name:"isInvalidEmail",required:!1,type:{name:"boolean"}},hiddenFields:{defaultValue:null,description:`A data object containing key/value pairs that will be added to the form
field submitted data.`,name:"hiddenFields",required:!1,type:{name:"any"}},isInvalidComment:{defaultValue:null,description:"Toggles the invalid state for the comment field.",name:"isInvalidComment",required:!1,type:{name:"boolean"}},notificationText:{defaultValue:null,description:`Used to add a notification above the description in the
initial/form view.`,name:"notificationText",required:!1,type:{name:"string | Element"}},showCategoryField:{defaultValue:null,description:"Toggles the category radio group field.",name:"showCategoryField",required:!1,type:{name:"boolean"}},showEmailField:{defaultValue:null,description:"Toggles the email input field. When set to `true`, an additional\nconfirmation message will be rendered.",name:"showEmailField",required:!1,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"Only used for internal purposes.",name:"isOpen",required:!1,type:{name:"boolean"}},onOpen:{defaultValue:null,description:"Only used for internal purposes.",name:"onOpen",required:!1,type:{name:"any"}},onClose:{defaultValue:null,description:"Only used for internal purposes.",name:"onClose",required:!1,type:{name:"any"}}}}}catch{}export{Z as F,nt as f};
//# sourceMappingURL=FeedbackBox-9e7be7e7.js.map
