import{a as t,j as e,F as v}from"./emotion-react-jsx-runtime.browser.esm-b12afd4d.js";import{r as b}from"./index-f2bd0723.js";import{B as c}from"./Button-a3ea41e0.js";import{B as R}from"./ButtonGroup-3ea9dbd7.js";import{F as ye,b as m}from"./Form-7babaf24.js";import{I as A}from"./Icon-6616a4b9.js";import{L as be}from"./Link-0ed02cf7.js";import{N as ge}from"./Notification-69d32803.js";import{R as H}from"./Radio-c107ee3b.js";import{R as xe}from"./RadioGroup-8ceb9bfa.js";import{T as y}from"./Text-eabcdc0a.js";import{u as we,T as G}from"./TextInput-3683470d.js";import{u as Ce}from"./useNYPLBreakpoints-91c0faa1.js";import{u as ke}from"./chakra-ui-hooks.esm-02e82f78.js";import{D as ve,g as Te,c as Ve,e as Be,a as Ie}from"./chakra-ui-modal.esm-af0e92e4.js";import{f as Fe,u as qe,g as Ee,V as De,B as M}from"./chakra-ui-layout.esm-b2fa9d31.js";const J={category:"comment",comment:"",email:""};function Oe(a,i){switch(i.type){case"category":return{...a,category:i.payload};case"comment":return{...a,comment:i.payload};case"email":return{...a,email:i.payload};case"clear":default:return J}}function Se(){const[a,i]=b.useReducer(Oe,J);return{state:a,setCategory:l=>i({type:"category",payload:l}),setComment:l=>i({type:"comment",payload:l}),setEmail:l=>i({type:"email",payload:l}),clearValues:()=>i({type:"clear"})}}const Ke=["form","confirmation","error"],Y=Fe(b.forwardRef(({className:a,confirmationText:i,descriptionText:g,hiddenFields:T,id:o="feedbackbox",isInvalidComment:N=!1,isInvalidEmail:l=!1,notificationText:w,onSubmit:j,showCategoryField:V=!1,showEmailField:C=!1,title:B,view:k="form",isOpen:_,onOpen:P,onClose:$,...K},Q)=>{const[r,u]=we(k),[s,I]=b.useState(!1),{state:x,setCategory:X,setComment:Z,setEmail:ee,clearValues:F}=Se(),{isLargerThanMobile:te}=Ce(),q=ke(),ne=_||q.isOpen,ie=P||q.onOpen,E=$||q.onClose,f=b.useRef(),p=qe("FeedbackBox",{}),D=r==="form",ae=r==="confirmation",O=r==="error",oe=3e3,L=500,re=165,le="auto 1fr",se=Ee(null,"dark.ui.typography.body"),de=235,ce=275,me=345,ue=37,fe=24;let d=re;const S=()=>{E(),u("form"),F()},pe=n=>{n.preventDefault();let h={...x};T&&(h={...h,...T}),j&&j(h),I(!0)},U=D&&w?e(ge,{isCentered:!0,noMargin:!0,notificationContent:w,showIcon:!1,p:"0",sx:{"> div":{py:"xs"}},width:"100%"}):void 0,z=D&&g?e(y,{fontWeight:"medium",noSpace:!0,children:g}):void 0,W=e(m,{children:e(be,{href:"https://www.nypl.org/help/about-nypl/legal-notices/privacy-policy",type:"external",fontSize:"text.tag",width:"fit-content",children:"Privacy Policy"})});b.useEffect(()=>{let n;return s&&(n=setTimeout(()=>{I(!1),u(O?"error":"confirmation"),F()},oe),k!==r&&(I(!1),u(k),clearTimeout(n))),()=>clearTimeout(n)},[F,O,s,u,k,r]),b.useEffect(()=>{let n;return(r==="error"||r==="confirmation")&&(n=setTimeout(()=>{var h;(h=f==null?void 0:f.current)==null||h.focus()},250)),()=>clearTimeout(n)},[f,r]),V&&(d=de),C&&(d=ce),V&&C&&(d=me),w&&(d+=ue),g&&(d+=fe),w&&g&&(d+=16);let he=d+"px";return t(M,{className:a,id:o,ref:Q,sx:p,...K,children:[e(c,{id:"open",onClick:ie,sx:p.openButton,children:B}),t(ve,{blockScrollOnMount:!1,isOpen:ne,onClose:E,placement:"bottom",children:[e(Ie,{}),t(Te,{sx:p.drawerContent,children:[t(c,{buttonType:"text",id:"close-btn",onClick:E,sx:p.closeButton,children:[e(A,{color:"ui.black",name:"minus",size:"medium"}),t("span",{children:["Close ",B]})]}),e(Ve,{sx:p.drawerHeader,children:e(y,{"data-testid":"title",children:B})}),e(Be,{sx:p.drawerBody,children:t(ye,{gap:"grid.s",id:"feedback-form",onSubmit:pe,sx:{".feedback-body":{alignItems:"flex-start",minHeight:he,gridTemplateRows:le},".feedback-body.response":{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center"}},children:[D&&t(v,{children:[t(De,{className:"feedback-body",spacing:"s",children:[(U||z)&&t(v,{children:[U,z]}),V&&e(m,{children:t(xe,{defaultValue:x.category,id:`${o}-category`,isDisabled:s,labelText:"What is your feedback about?",layout:te?"row":"column",name:`${o}-category`,onChange:n=>X(n),children:[e(H,{id:"comment",labelText:"Comment",value:"comment"}),e(H,{id:"correction",labelText:"Correction",value:"correction"}),e(H,{id:"bug",labelText:"Bug",value:"bug"})]})}),e(m,{width:"100%",children:e(G,{helperText:`${L-x.comment.length} characters remaining`,id:`${o}-comment`,invalidText:"Please fill out this field.",isDisabled:s,isInvalid:N,isRequired:!0,labelText:"Comment",maxLength:L,name:`${o}-comment`,onChange:n=>Z(n.target.value),placeholder:"Enter your question or feedback here",type:"textarea",defaultValue:x.comment})}),C&&e(m,{width:"100%",children:e(G,{id:`${o}-email`,invalidText:"Please enter a valid email address.",isDisabled:s,isInvalid:l,labelText:"Email",name:`${o}-email`,onChange:n=>ee(n.target.value),placeholder:"Enter your email address here",type:"email",value:x.email})})]}),W,e(m,{children:t(R,{buttonWidth:"full",id:"submit-cancel",children:[e(c,{buttonType:"secondary",id:"cancel",isDisabled:s,onClick:S,children:"Cancel"},"cancel"),e(c,{id:"submit",isDisabled:s,type:"submit",children:"Submit"},"submit")]})})]}),ae&&t(v,{children:[t(M,{className:"feedback-body response",margin:"auto",tabIndex:0,textAlign:"center",ref:f,children:[e(A,{color:se,name:"actionCheckCircleFilled",size:"large"}),e(y,{fontWeight:"medium",children:"Thank you for submitting your feedback."}),C&&e(y,{children:"If you provided an email address and require a response, our service staff will reach out to you via email."}),i?e(y,{children:i}):void 0]},"confirmationWrapper"),W,e(m,{children:e(R,{buttonWidth:"full",id:"submit-cancel",children:e(c,{id:"return-browsing",buttonType:"secondary",onClick:S,children:"Return to Browsing"})})})]}),O&&t(v,{children:[t(M,{className:"feedback-body response",color:"ui.error.primary",margin:"auto",tabIndex:0,textAlign:"center",ref:f,children:[e(A,{color:"ui.error.primary",name:"errorFilled",size:"large"}),e(y,{fontWeight:"medium",children:"Oops! Something went wrong. An error occured while processing your feedback."})]},"errorWrapper"),W,e(m,{children:t(R,{buttonWidth:"full",id:"submit-cancel",children:[e(c,{id:"return-browsing2",buttonType:"secondary",onClick:S,children:"Return to Browsing"},"return-browsing2"),e(c,{id:"try-again",onClick:()=>u("form"),children:"Try Again"},"try-again")]})})]})]})})]})]})]})}));try{Y.displayName="FeedbackBox",Y.__docgenInfo={description:"The `FeedbackBox` component renders a fixed-positioned button on the bottom\nright corner of a page that opens a Chakra `Drawer` popup component. Inside\nof the popup, a form is rendered with fields that allows users to provide\nfeedback. The `FeedbackBox` component does *not* call any API with the\nsubmitted data; that feature is the responsibility of the consuming\napplication.",displayName:"FeedbackBox",props:{title:{defaultValue:null,description:"Used to populate the label on the open button and the `Drawer`'s\nheader title.",name:"title",required:!0,type:{name:"string"}},view:{defaultValue:null,description:"Used to specify what screen should be displayed.",name:"view",required:!1,type:{name:'"form" | "confirmation" | "error"'}},className:{defaultValue:null,description:"Additional class name to add.",name:"className",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"ID that other components can cross reference for accessibility purposes",name:"id",required:!1,type:{name:"string"}},descriptionText:{defaultValue:null,description:`Used to add description text above the form input fields in
the initial/form view.`,name:"descriptionText",required:!1,type:{name:"string | Element"}},onSubmit:{defaultValue:null,description:"Callback function that will be invoked when the form is submitted.\nThe returned data object contains key/value pairs including the\nvalues from the `hiddenFields` prop.",name:"onSubmit",required:!0,type:{name:"(values: { [key: string]: string; }) => any"}},confirmationText:{defaultValue:null,description:`Used to add additional information to the default confirmation message in
the confirmation view.`,name:"confirmationText",required:!1,type:{name:"string | Element"}},hiddenFields:{defaultValue:null,description:`A data object containing key/value pairs that will be added to the form
field submitted data.`,name:"hiddenFields",required:!1,type:{name:"any"}},isInvalidComment:{defaultValue:null,description:"Toggles the invalid state for the comment field.",name:"isInvalidComment",required:!1,type:{name:"boolean"}},isInvalidEmail:{defaultValue:null,description:"Toggles the invalid state for the email field.",name:"isInvalidEmail",required:!1,type:{name:"boolean"}},notificationText:{defaultValue:null,description:`Used to add a notification above the description in the
initial/form view.`,name:"notificationText",required:!1,type:{name:"string | Element"}},showCategoryField:{defaultValue:null,description:"Toggles the category radio group field.",name:"showCategoryField",required:!1,type:{name:"boolean"}},showEmailField:{defaultValue:null,description:"Toggles the email input field. When set to `true`, an additional\nconfirmation message will be rendered.",name:"showEmailField",required:!1,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"Only used for internal purposes.",name:"isOpen",required:!1,type:{name:"boolean"}},onOpen:{defaultValue:null,description:"Only used for internal purposes.",name:"onOpen",required:!1,type:{name:"any"}},onClose:{defaultValue:null,description:"Only used for internal purposes.",name:"onClose",required:!1,type:{name:"any"}}}}}catch{}export{Y as F,Ke as f};
//# sourceMappingURL=FeedbackBox-8fd366e4.js.map
